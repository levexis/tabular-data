<!DOCTYPE html>
<html>
<script src="/js/vendor/jquery.min.js"></script>
<script>
    // capture load start time
    window.results=[ new Date() ];
    window.labels=[ 'start' ];
    window.disableTimestrap = true;
</script>
<script>
    function logEvent ( what ) {
        return function () {
            console.log( what, new Date(),(new Date()).getTime() );
            timeStrap( what );
        };
    }
    function appendScript(src) {
        var head = document.getElementsByTagName( "head" )[0];
        var js = document.createElement( "script" );
        js.onload = logEvent ('append script');
        js.src = src;
        head.appendChild( js );
    }
    function writeScript(src) {
        document.write('<scr' + 'ipt src="' + src + '" onload="logEvent(\'write script\')()"></scr' + 'ipt>');
    }
    // creates an image which will be precached
    function cacheImage(src) {
        var img = new image();
        img.src = src;
        img.width= 1;
        img.height= 1;
        img.onload = logEvent ('cached image');
        return img;
    }
    // include the #
    function appendImage (src, el) {
        $(el).append('<img src="'+src+'" height="1px" width="1px" onload="logEvent(\'append img\')()">');
    }

    function addCss(src) {
        var head = document.getElementsByTagName( "head" )[0];
        var link = document.createElement( "link" );
        link.rel = "stylesheet";
        link.type = "text/css";
        link.onload = logEvent ('dynamic css');
        link.href = src;
        head.appendChild( link );
    }

    // bootstrap
    window.addEventListener('load', logEvent('Window.Load') );
    $( logEvent('Dom ready' ) );
    function doSomething(cycles, timeout) {
        var starttime = new Date(), i = 0, elapsed = 0, a = [];
        if ( typeof cycles === 'undefined' ) {
            cycles = 1000000;
        }
        for ( i = 0; ( (!cycles || i < cycles) && (!timeout || elapsed < timeout) ) ; i++ ) {
            elapsed = new Date().getTime() - starttime.getTime();
            a.push( document.getElementsByTagName( 'head' ).count );
        }
        console.log('something took ', elapsed  );
        logEvent('finishedSomething')()
        return elapsed;
    }
    </script>
<head>
    <meta charset="utf-8">
    <title>Blocking Test</title>
    <script src="timer.js?sync"></script>
</head>
<body>
<script>
setTimeout( function () {
    doSomething( false, 2000);
},0);
</script>
<h1>render test</h1>
no css, something 1 ( script .5s load .5s exec) then link, then results div, then latin, then something 3 blocking dom and window.
aysnc script loaded using timeout does not block paint as executes after paint
Will not paint whilst async script executing.
<a id="mylink" href="#" onclick="logEvent('clicked link')()">test link</a>
<div id="results" style="font-size: 24pt">results</div>
<script src="latin.js"></script><script>document.write('<p>'+generateLatin()+'<p>');</script>
</body>
</html>
